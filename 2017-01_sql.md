<style>
  .slide { 
  	background-color:#000; 
  	color:#fff; 
   } 

  pre { 
  	color:#000; 
    } 
  h1, h2, h3, h4, h5, h6 { 
  	color:#fff !important;
  } 

</style>

<!-- page_number: true -->
<!-- footer: Simplon Toulouse Promo 02 - SQL 101-->


# SQL 101

---

# Roadmap
* So far, so good ?
* Les bases de données
* De SGBD à SQL
* SQl vs NoSQL

---

```
fs.readFile(pathToFile, "utf8", function(error, data){

    var objectParsed = JSON.parse(data);
    var customers = objectParsed.customers;

    customers.push(newCustomer);

    var newGlobalObject = {
    	customers : customers
    };
	
    var newGlobalObjectString = 
    	  JSON.stringify(newGlobalObject);
	
    fs.writeFile(pathToFile, newGlobalObjectString, 
    	 function(err){
		console.log("File written");
		response.json(customers);
	})
})
```

---


# Comment stocker des données ?

&nbsp;
* Variable
* localStorage
* $_Session
* $_Cookie

---

# Les Bases De Données - DB

---

Une base de données est un outil permettant de stocker et de retrouver l'intégralité des informations stockées.

---

## Comme un fichier .txt ou .json ?

---

Les informations sont classées, hiérarichées, organisées ... 

&nbsp;
&nbsp;
![center 50%](./Downloads/logo-mr-propre.png)

---

# Du SGBD au SQL

---

## SGBD

* Système de Gestion de Base de Données.

* Programme en charge de la base de données.

* Communique avec la DB grâce à un langage : le SQL

---

## Des exemples de SGBD

* MySQL
* PostgreSQL
* SQLite
* Oracle
* Microsoft SQL Server

---

![center 150%](https://user.oc-static.com/files/218001_219000/218680.png)

&nbsp;
&nbsp;
<small>source : openclassrooms.com</small>

---

# Un peu de vocabulaire
* base
* table
* champs
* entrées


---

## Base
L'armoire

---

## Base
L'armoire


## Table
Le tiroir

---

## Base
L'armoire


## Table
Le tiroir

## Champs
Les propriétés (des chaussettes : couleur, pointure, °C de lavage...)


---

## Base
L'armoire


## Table
Le tiroir

## Champs
Les propriétés (des chaussettes : couleur, pointure, °C de lavage...)

## Entrées
Les chaussettes qui se trouvent dans le tiroir, ayant des propriétés différentes les unes des autres



---

![center 200%](https://user.oc-static.com/files/59001_60000/59541.png)

<small>source : openclassrooms.com</small>

---

# SQL - Structured Query Language
> SQL est un langage informatique normalisé servant à exploiter des bases de données relationnelles. La partie langage de manipulation des données de SQL permet de rechercher, d'ajouter, de modifier ou de supprimer des données dans les bases de données relationnelles.
> Wikipédia

---

`
SELECT couleur, pointure FROM tiroir_chaussettes ORDER BY date_lavage DESC
`

---

`
SELECT couleur, pointure FROM tiroir_chaussettes ORDER BY date_lavage DESC
`

---

`
SELECT couleur, pointure FROM tiroir_chaussettes ORDER BY date_lavage DESC
`

---

```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| vetements          |
+--------------------+

```

---

```
mysql> use vetements; 
mysql> show tables;                                                                                                                                                      
+---------------------+
| Tables_in_vetements |
+---------------------+
| Etagere_pantalon    |
| Tiroir_chaussettes  |
| Tiroir_slips        |
+---------------------+
```

---

# SELECT

---
```
mysql> SELECT * FROM tiroir_chaussettes;
```

+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
+----+---------+--------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * FROM tiroir_chaussettes;
```

+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
+----+---------+--------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * FROM tiroir_chaussettes;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
+----+---------+--------------------+----------+---------------------+-------------+



---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes;
```

+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  1 |       45 |          40 |
|  2 |       39 |          40 |
|  3 |       40 |          40 |
|  4 |       40 |          60 |
|  5 |       42 |          50 |
+----+----------+-------------+

---

# WHERE

---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes WHERE id=2;
```

+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  2 |       39 |          40 |
+----+----------+-------------

---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes WHERE pointure=40;
```

+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  3 |       40 |          40 |
|  4 |       40 |          60 |
+----+----------+------------


---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes WHERE pointure>=40;
```
+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  1 |       45 |          40 |
|  3 |       40 |          40 |
|  4 |       40 |          60 |
|  5 |       42 |          50 |
+----+----------+-------------+

---
```
mysql> SELECT * 
FROM tiroir_chaussettes WHERE pointure>=40;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
+----+---------+--------------------+----------+---------------------+-------------+

---

# Opérateurs de comparaison
* =
* <
* <=
* >
* >=
* <>   ou   !=
* <=>

---
```
mysql> SELECT * 
FROM tiroir_chaussettes 
WHERE pointure>=40 AND date_lavage>'2017-01-01';
```
+----+---------+------------------+----------+---------------------+-------------+
| id | couleur | description      | pointure | date_lavage         | temp_lavage |
+----+---------+------------------+----------+---------------------+-------------+
|  3 | bleu    |                  |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures |       42 | 2017-01-10 12:00:00 |          50 |
+----+---------+------------------+----------+---------------------+-------------+

----

# Opérateurs WHERE
* AND  
	* &&
* OR 
	* ||
* XOR
* NOT 
	* !
---

---

# ORDER BY

---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes 
ORDER BY pointure;
```

+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  2 |       39 |          40 |
|  3 |       40 |          40 |
|  4 |       40 |          60 |
|  5 |       42 |          50 |
|  1 |       45 |          40 |
+----+----------+-------------+

---

```
mysql> SELECT id, pointure, temp_lavage 
FROM tiroir_chaussettes 
ORDER BY pointure DESC;
```
+----+----------+-------------+
| id | pointure | temp_lavage |
+----+----------+-------------+
|  1 |       45 |          40 |
|  5 |       42 |          50 |
|  3 |       40 |          40 |
|  4 |       40 |          60 |
|  2 |       39 |          40 |
+----+----------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
ORDER BY pointure;
```

+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
+----+---------+--------------------+----------+---------------------+-------------+


---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
ORDER BY pointure, temp_lavage;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
+----+---------+--------------------+----------+---------------------+-------------+

---

# Eliminer les doublons : DISTINCT

---

```
mysql> SELECT couleur 
FROM tiroir_chaussettes;
```
+---------+
| couleur |
+---------+
| rose    |
| bleu    |
| bleu    |
| blanc   |
| jaune   |
| noir    |
+---------+


---

```
mysql> SELECT  DISTINCT couleur 
FROM tiroir_chaussettes;
```
+---------+
| couleur |
+---------+
| rose    |
| bleu    |
| blanc   |
| jaune   |
| noir    |
+---------+

---

# Application

Récupérer les différentes pointures (sans doublon).

---

```
mysql> SELECT pointure 
FROM tiroir_chaussettes;
```
+----------+
| pointure |
+----------+
|       45 |
|       39 |
|       40 |
|       40 |
|       42 |
|       40 |
+----------+

---

```
mysql> SELECT DISTINCT pointure 
FROM tiroir_chaussettes;
```

+----------+
| pointure |
+----------+
|       45 |
|       39 |
|       40 |
|       42 |
+----------+

---
# Restreindre les résultats : LIMIT
---

```
mysql> SELECT * 
FROM tiroir_chaussettes;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
+----+---------+--------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
LIMIT 3;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
+----+---------+--------------------+----------+---------------------+-------------+


---


```
mysql> SELECT * 
FROM tiroir_chaussettes 
LIMIT 3 OFFSET 2;
```
+----+---------+------------------+----------+---------------------+-------------+
| id | couleur | description      | pointure | date_lavage         | temp_lavage |
+----+---------+------------------+----------+---------------------+-------------+
|  3 | bleu    |                  |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures |       42 | 2017-01-10 12:00:00 |          50 |
+----+---------+------------------+----------+---------------------+-------------+

---

# A little further

---

```
mysql> SELECT * 
FROM tiroir_chaussettes;
```
+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
+----+---------+--------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
ORDER BY temp_lavage;
```

+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  5 | jaune   | avec des rayures   |       42 | 2017-01-10 12:00:00 |          50 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
|  4 | blanc   | avec des rayures   |       40 | 2017-01-10 12:00:00 |          60 |
+----+---------+--------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
ORDER BY temp_lavage 
LIMIT 4;
```

+----+---------+--------------------+----------+---------------------+-------------+
| id | couleur | description        | pointure | date_lavage         | temp_lavage |
+----+---------+--------------------+----------+---------------------+-------------+
|  1 | rose    | déteignent un peu  |       45 | 2010-09-13 15:02:00 |          40 |
|  2 | bleu    |                    |       39 | 2017-09-13 15:02:00 |          40 |
|  3 | bleu    |                    |       40 | 2017-01-13 12:04:00 |          40 |
|  7 | noir    |                    |       40 | 2017-01-13 12:00:00 |          50 |
+----+---------+--------------------+----------+---------------------+-------------+


---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
ORDER BY temp_lavage 
LIMIT 4 OFFSET 2;
```

+----+---------+------------------+----------+---------------------+-------------+
| id | couleur | description      | pointure | date_lavage         | temp_lavage |
+----+---------+------------------+----------+---------------------+-------------+
|  3 | bleu    |                  |       40 | 2017-01-13 12:04:00 |          40 |
|  5 | jaune   | avec des rayures |       42 | 2017-01-10 12:00:00 |          50 |
|  7 | noir    |                  |       40 | 2017-01-13 12:00:00 |          50 |
|  4 | blanc   | avec des rayures |       40 | 2017-01-10 12:00:00 |          60 |
+----+---------+------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
WHERE date_lavage > '2017-01-01' 
ORDER BY temp_lavage 
LIMIT 4 OFFSET 2;
```

+----+---------+------------------+----------+---------------------+-------------+
| id | couleur | description      | pointure | date_lavage         | temp_lavage |
+----+---------+------------------+----------+---------------------+-------------+
|  5 | jaune   | avec des rayures |       42 | 2017-01-10 12:00:00 |          50 |
|  7 | noir    |                  |       40 | 2017-01-13 12:00:00 |          50 |
|  4 | blanc   | avec des rayures |       40 | 2017-01-10 12:00:00 |          60 |
+----+---------+------------------+----------+---------------------+-------------+

---

```
mysql> SELECT * 
FROM tiroir_chaussettes 
WHERE date_lavage > '2017-01-01' && pointure = 40 
ORDER BY temp_lavage 
LIMIT 4 OFFSET 2;
```

+----+---------+------------------+----------+---------------------+-------------+
| id | couleur | description      | pointure | date_lavage         | temp_lavage |
+----+---------+------------------+----------+---------------------+-------------+
|  4 | blanc   | avec des rayures |       40 | 2017-01-10 12:00:00 |          60 |
+----+---------+------------------+----------+---------------------+-------------+

---

```
mysql> SELECT description 
FROM tiroir_chaussettes 
WHERE date_lavage > '2017-01-01' && pointure = 40 
ORDER BY temp_lavage 
LIMIT 4 OFFSET 2;
```

+------------------+
| description      |
+------------------+
| avec des rayures |
+------------------+

---

# Modification et suppression

---

```
mysql> UPDATE tiroir_chaussettes 
SET couleur = 'rose'
WHERE couleur = 'rouge;
```

---

```
mysql> DELETE 
FROM tiroir_chaussettes 
WHERE id = 7;
```


---

# Clés primaires
 
* unique
* une ou plusieurs colonnes (composite)
* identifie de manière unique chaque ligne

---

# Clés étrangères
*

---

# Jointures


---

# Opérations

---

# Fonctions scalaires

---

# Agrégateurs

---

# Regroupements

---

# Ressources

* https://fr.wikipedia.org/wiki/Base_de_donn%C3%A9es
* https://fr.wikipedia.org/wiki/Structured_Query_Language
* https://openclassrooms.com/courses/administrez-vos-bases-de-donnees-avec-mysql
* https://openclassrooms.com/courses/concevez-votre-site-web-avec-php-et-mysql/presentation-des-bases-de-donnees-2
* https://doc.ubuntu-fr.org/mysql
* http://sql.sh/cours/

---


---

```
CREATE TABLE [IF NOT EXISTS] Tiroir_chaussettes (
  id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
  couleur VARCHAR(20),
  description VARCHAR(80),
  pointure SMALLINT UNSIGNED,
  date_lavage DATETIME,
  temp_lavage SMALLINT UNSIGNED,
  PRIMARY KEY (id)

)
ENGINE=INNODB;
```

---

```
INSERT INTO tiroir_chaussettes 

VALUES (1, "rose", "déteignent un peu", 45, 
	'2010-09-13 15:02:00', 40);
```
